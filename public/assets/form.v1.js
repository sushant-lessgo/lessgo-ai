!function(){"use strict";function e(e,t){const o=e.parentElement.querySelector(".lessgo-form-error");o&&o.remove();const r=document.createElement("div");r.className="lessgo-form-error",r.textContent=t,r.style.cssText="color: #DC2626; font-size: 0.875rem; margin-top: 0.25rem;",e.parentElement.appendChild(r),e.style.borderColor="#DC2626"}function t(e,t){const o=`\n      <div class="bg-green-50 border border-green-200 rounded-2xl p-8">\n        <div class="text-center">\n          <div class="text-green-600 text-2xl mb-2">âœ“</div>\n          <h3 class="text-lg font-semibold text-green-900 mb-1">Thank you!</h3>\n          <p class="text-green-700">${function(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}(t||"Your submission has been received.")}</p>\n        </div>\n      </div>\n    `;e.outerHTML=o}function o(e,t){const o=e.querySelector(".lessgo-form-status");o&&o.remove();const r=document.createElement("div");r.className="lessgo-form-status",r.textContent=t,r.style.cssText="background: #FEE2E2; color: #DC2626; padding: 0.75rem; border-radius: 0.5rem; margin-top: 1rem; font-size: 0.875rem;",e.appendChild(r),setTimeout(()=>r.remove(),5e3)}async function r(r){r.preventDefault();const n=r.target,s=n.querySelector('button[type="submit"]'),a=s?s.textContent:"";if(!function(t){let o=!0;return t.querySelectorAll("input, textarea, select").forEach(t=>{if(function(e){const t=e.parentElement.querySelector(".lessgo-form-error");t&&t.remove(),e.style.borderColor=""}(t),t.hasAttribute("required")&&!t.value.trim())return e(t,"This field is required"),void(o=!1);var r;"email"===t.type&&t.value.trim()&&((r=t.value.trim())&&r.includes("@")&&r.includes(".")||(e(t,"Please enter a valid email address"),o=!1))}),o}(n))return;const i=n.dataset.formId,d=n.dataset.pageId,c=n.dataset.ownerId,l=n.dataset.successMessage;if(!i||!d||!c)return void o(n,"Form configuration error. Please contact support.");s&&(s.disabled=!0,s.textContent="Submitting...");const u=new FormData(n),m={};u.forEach((e,t)=>{m[t]=e});try{const e=await fetch("/api/forms/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({formId:i,data:m,publishedPageId:d,userId:c}),keepalive:!0}),r=await e.json();e.ok?("function"==typeof window._lessgoTrack&&window._lessgoTrack("form_submit",{formId:i,pageId:d}),t(n,l)):(o(n,r.message||"Submission failed. Please try again."),s&&(s.disabled=!1,s.textContent=a))}catch(e){console.error("Form submission error:",e),o(n,"Network error. Please check your connection and try again."),s&&(s.disabled=!1,s.textContent=a)}}function n(){const e=document.querySelectorAll("[data-lessgo-form]");e.forEach(e=>{e.addEventListener("submit",r)}),console.log(`[Lessgo Forms] Initialized ${e.length} form(s)`)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n()}();